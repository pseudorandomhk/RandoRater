<randomizer>
  <!--Macros used in all modes-->
  <macro name="SHADOWDASH">Mothwing_Cloak + Shade_Cloak</macro>
  <macro name="CREST">City_Crest</macro>
  <macro name="SIMPLE1">Simple_Key-Sly | Simple_Key-City | Simple_Key-Basin | Simple_Key-Lurker</macro>
  <macro name="SIMPLE3">(Simple_Key-Sly + Simple_Key-City + Simple_Key-Basin) | (Simple_Key-Lurker + Simple_Key-City + Simple_Key-Basin) | (Simple_Key-Sly + Simple_Key-Lurker + Simple_Key-Basin) | (Simple_Key-Sly + Simple_Key-City + Simple_Key-Lurker)</macro>
  <macro name="SIMPLE4">Simple_Key-Sly + Simple_Key-City + Simple_Key-Basin + Simple_Key-Lurker</macro>
  <macro name="TRAM">Tram_Pass</macro>
  <macro name="LANTERN">Lumafly_Lantern</macro>
  <macro name="SHOPKEY">Shopkeeper's_Key</macro>
  <macro name="ELEGANT">Elegant_Key</macro>
  <macro name="LOVE">Love_Key</macro>
  <macro name="BRAND">King's_Brand</macro>
  <macro name="KINGSOUL">(Queen_Fragment + King_Fragment) | (Queen_Fragment + Void_Heart) | (King_Fragment + Void_Heart)</macro>
  <macro name="VOIDHEART">Queen_Fragment + King_Fragment + Void_Heart</macro>
  <macro name="BALDURS">FIREBALL | QUAKE | Grubberfly's_Elegy | Glowing_Womb | (DASH + Dash_Slash) | (MILDSKIPS + (Weaversong | (Spore_Shroom + (NOTCURSED | Focus)))) | ((Mark_of_Pride | Cyclone_Slash | DASH) + SPICYSKIPS)</macro>
  <macro name="SHARPSHADOW">Sharp_Shadow + SHADOWDASH</macro>
  <macro name="DASHMASTER">Dashmaster + DASH</macro>
  <macro name="INFECTED">(Lurien | Monomon | Herrah | Dreamer) + SPICYSKIPS</macro>
  <macro name="DREAMER3">(Lurien + Monomon + Herrah) | (Dreamer + Monomon + Herrah) | (Lurien + Dreamer + Herrah) | (Lurien + Monomon + Dreamer)</macro>
  <macro name="AWOKEN">Dream_Nail + Dream_Gate + Awoken_Dream_Nail</macro>
  <macro name="AIRSTALL">FIREBALLSKIPS + (FIREBALL | SCREAM)</macro>
  <macro name="TUNNEL">SPIKETUNNELS + DASH + (Dashmaster | FIREBALL | SCREAM)</macro>
  <macro name="SKIPACID">CLAW + DASH + SUPERDASH + ACIDSKIPS</macro>
  <macro name="MINIBOSS">FIREBALL | SCREAM | QUAKE | SPICYSKIPS</macro>
  <macro name="AERIALMINIBOSS">((FIREBALL | SCREAM) + (DASH | MILDSKIPS)) | SPICYSKIPS</macro>
  <macro name="BOSS">(Vengeful_Spirit + Shade_Soul) | (Desolate_Dive + Descending_Dark) | (Howling_Wraiths + Abyss_Shriek) | (FIREBALL + QUAKE) | (SCREAM + QUAKE) | (FIREBALL + SCREAM)</macro>
  <macro name="ALLSTAGS">Crossroads_Stag + Greenpath_Stag + Queen's_Station_Stag + Queen's_Gardens_Stag + City_Storerooms_Stag + King's_Station_Stag + Resting_Grounds_Stag + Distant_Village_Stag + Hidden_Station_Stag</macro>
  <macro name="LIFEBLOOD">Lifeblood_Heart | Lifeblood_Core | Joni's_Blessing</macro>

  <!--Room Rando Macros, mainly for simplifying complex rooms, or simplifying room references for item logic-->
  <macro name="CANSTAG-R">Room_Town_Stag_Station[left1] | Crossroads_47[right1] | Fungus1_16_alt[right1] | Fungus2_02[right1] | (Fungus3_40[top1] | Fungus3_40[right1]) | Ruins1_29[left1] | Ruins2_08[left1] | RestingGrounds_09[left1] | Deepnest_09[left1] | Abyss_22[left1]</macro>
  <macro name="ALLSTAGS-R">Crossroads_47[right1] + Fungus1_16_alt[right1] + Fungus2_02[right1] + (Fungus3_40[top1] | Fungus3_40[right1]) + Ruins1_29[left1] + Ruins2_08[left1] + RestingGrounds_09[left1] + Deepnest_09[left1] + Abyss_22[left1]</macro>

  <macro name="Tutorial_01">Tutorial_01[right1] | Tutorial_01[top1] | Tutorial_01[top2]</macro>
  
  <macro name="Town">Town[left1] | Town[top1] | Town[bot1] | Town[right1] | Town[door_station] | Town[door_sly] | Town[door_mapper] | Town[door_bretta] | Town[door_jiji]</macro>
  
  <macro name="Crossroads_03">Crossroads_03[right1] | Crossroads_03[right2] | Crossroads_03[left1] | Crossroads_03[left2] | Crossroads_03[bot1]</macro>
  <macro name="Crossroads_04">Crossroads_04[left1] | Crossroads_04[top1] | Crossroads_04[door_Mender_House] | Crossroads_04[door1] | Crossroads_04[door_charmshop] | Crossroads_04[right1]</macro>
  <macro name="Crossroads_07">Crossroads_07[left1] | Crossroads_07[left2] | Crossroads_07[left3] | Crossroads_07[right1] | Crossroads_07[right2] | Crossroads_07[bot1]</macro>
  <macro name="Crossroads_08">Crossroads_08[left1] | Crossroads_08[left2] | Crossroads_08[right1] | Crossroads_08[right2]</macro>
  <macro name="Crossroads_10">Crossroads_10[right1] | (Crossroads_10[left1] + CLAW)</macro>
  <macro name="Crossroads_14">Crossroads_14[left1] | Crossroads_14[left2] | Crossroads_14[right1] | Crossroads_14[right2]</macro>
  <macro name="Crossroads_18">(Crossroads_18[right1] + (DASH | WINGS | (INFECTED + SPICYSKIPS))) | Crossroads_18[bot1] | Crossroads_18[right2]</macro>
  <macro name="Crossroads_19">Crossroads_19[left1] | Crossroads_19[left2] | Crossroads_19[right1] | Crossroads_19[top1]</macro>
  <macro name="Crossroads_21">Crossroads_21[left1] | Crossroads_21[right1] | Crossroads_21[top1]</macro>
  <macro name="Crossroads_27">Crossroads_27[right1] | Crossroads_27[bot1] | Crossroads_27[left1] | Crossroads_27[left2]</macro>
  <macro name="Crossroads_33">Crossroads_33[top1] | Crossroads_33[left1] | Crossroads_33[left2] | Crossroads_33[right1] | Crossroads_33[right2]</macro>
  
  <macro name="Fungus1_04">(Fungus1_04[left1] + (DASH | WINGS | (CLAW + (SUPERDASH | ACID)))) | Fungus1_04[right1]</macro>
  <macro name="Fungus1_11">Fungus1_11[left1] | Fungus1_11[top1] | Fungus1_11[bot1] | Fungus1_11[right1] | Fungus1_11[right2]</macro>
  <macro name="Fungus1_21">Fungus1_21[left1] | Fungus1_21[top1] | (Fungus1_21[right1] + (CLAW | WINGS | DASH)) | Fungus1_21[bot1]</macro>
  <macro name="Fungus1_30">Fungus1_30[left1] | Fungus1_30[right1] | Fungus1_30[top1] | Fungus1_30[top3]</macro>
  
  <macro name="Fungus3_01">Fungus3_01[left1] | Fungus3_01[top1] | Fungus3_01[right1] | Fungus3_01[right2]</macro>
  <macro name="Fungus3_02">Fungus3_02[left1] | Fungus3_02[left2] | Fungus3_02[left3] | Fungus3_02[right1] | Fungus3_02[right2]</macro>
  <macro name="Fungus3_26">Fungus3_26[top1] | Fungus3_26[left1] | Fungus3_26[left2] | Fungus3_26[left3] | Fungus3_26[right1]</macro>
  <macro name="Fungus3_44">(Fungus3_44[bot1] + (CLAW | (WINGS + SHADOWDASH))) | Fungus3_44[door1] | Fungus3_44[right1]</macro>
  <macro name="Fungus3_47">Fungus3_47[left1] | Fungus3_47[door1] | Fungus3_47[right1]</macro>
  
  <macro name="Fungus2_01">Fungus2_01[left1] | Fungus2_01[left2] | Fungus2_01[left3] | Fungus2_01[right1]</macro>
  <macro name="Fungus2_03">Fungus2_03[left1] | Fungus2_03[bot1] | Fungus2_03[right1]</macro>
  <macro name="Fungus2_04">Fungus2_04[left1] | Fungus2_04[right1] | Fungus2_04[right2] | Fungus2_04[top1]</macro>
  <macro name="Fungus2_06">Fungus2_06[left1] | (Fungus2_06[left2] + ACID) | Fungus2_06[top1] | Fungus2_06[right1] | Fungus2_06[right2]</macro>
  <macro name="Fungus2_11">Fungus2_11[top1] | Fungus2_11[left1] | Fungus2_11[left2] | Fungus2_11[right1]</macro>
  <macro name="Fungus2_13">Fungus2_13[top1] | Fungus2_13[left2] | (Fungus2_13[left3] + (DASH | ACID | WINGS))</macro>
  <macro name="Fungus2_15">(Fungus2_15[left1] + CLAW) | Fungus2_15[top3] | Fungus2_15[right1]</macro>
  <macro name="Fungus2_17">Fungus2_17[right1] | Fungus2_17[left1] | Fungus2_17[bot1]</macro>
  <macro name="Fungus2_20">Fungus2_20[left1] | Fungus2_20[right1]</macro>
  <macro name="Fungus2_23">Fungus2_23[right1] | (Fungus2_23[right2] + (CLAW | WINGS) + (Waterways_09[left1] | Waterways_09[right1]))</macro>
  <macro name="Deepnest_01">Deepnest_01[left1] | Deepnest_01[bot1] | Deepnest_01[right1]</macro>
  
  <macro name="Deepnest_01b">Deepnest_01b[top1] | Deepnest_01b[top2] | Deepnest_01b[right1] | (Deepnest_01b[right2] + (CLAW | WINGS)) | (Deepnest_01b[bot1] + CLAW)</macro>
  <macro name="Deepnest_02">Deepnest_02[left1] | Deepnest_02[left2] | Deepnest_02[right1]</macro>
  <macro name="Deepnest_03">Deepnest_03[right1] | Deepnest_03[top1] | Deepnest_03[left1] | Deepnest_03[left2]</macro>
  <macro name="Deepnest_10">Deepnest_10[right1] | Deepnest_10[right2] | Deepnest_10[door1] | Deepnest_10[door2]</macro>
  <macro name="Deepnest_14">Deepnest_14[left1] | Deepnest_14[bot1] | Deepnest_14[bot2]</macro>
  <macro name="Deepnest_17">Deepnest_17[left1] | Deepnest_17[right1] | Deepnest_17[top1] | Deepnest_17[bot1]</macro>
  <macro name="Deepnest_26">Deepnest_26[right1] | Deepnest_26[bot1] | (Deepnest_26[left1] + Deepnest_26b[right2] + (CLAW | WINGS))</macro>
  <macro name="Deepnest_34">(LANTERN | DARKROOMS) + (Deepnest_34[left1] | Deepnest_34[right1] | Deepnest_34[top1])</macro>
  <macro name="Deepnest_35">(LANTERN | DARKROOMS) + ((Deepnest_35[bot1] + CLAW) | Deepnest_35[left1] | Deepnest_35[top1])</macro>
  <macro name="Deepnest_37">Deepnest_37[left1] | Deepnest_37[top1] | Deepnest_37[right1] | Deepnest_37[bot1]</macro>
  <macro name="Deepnest_39">(LANTERN | DARKROOMS) + (Deepnest_39[right1] | Deepnest_39[door1] | Deepnest_39[top1] | Deepnest_39[left1])</macro>
  <macro name="Deepnest_41">(LANTERN | DARKROOMS) + ((Deepnest_41[left1] + CLAW) | (Deepnest_41[left2] + CLAW) | (Deepnest_41[right1] + (CLAW | WINGS)))</macro>
  <macro name="Deepnest_42">(LANTERN | DARKROOMS) + ((Deepnest_42[bot1] + CLAW) | Deepnest_42[left1] | Deepnest_42[top1])</macro>
  
  <macro name="Deepnest_East_02">(Deepnest_East_02[bot1] + (CLAW | WINGS)) | Deepnest_East_02[top1] | Deepnest_East_02[right1]</macro>
  <macro name="Deepnest_East_03">Deepnest_East_03[left1] | Deepnest_East_03[left2] | Deepnest_East_03[top1] | Deepnest_East_03[right1] | Deepnest_East_03[right2] | Deepnest_East_03[top2]</macro>
  <macro name="Deepnest_East_04">(Deepnest_East_04[left1] + ACID) | Deepnest_East_04[left2] | Deepnest_East_04[right2] | (Deepnest_East_04[right1] + (ACID | DASH | SUPERDASH | WINGS))</macro>
  <macro name="Deepnest_East_06">Deepnest_East_06[left1] | Deepnest_East_06[top1] | Deepnest_East_06[bot1] | Deepnest_East_06[door1] | Deepnest_East_06[right1]</macro>
  <macro name="Deepnest_East_07">Deepnest_East_07[right1] | Deepnest_East_07[left1] | Deepnest_East_07[left2]</macro>
  <macro name="Deepnest_East_11">Deepnest_East_11[left1] | Deepnest_East_11[bot1] | Deepnest_East_11[top1] | Deepnest_East_11[right1]</macro>
  <macro name="Deepnest_East_18">Deepnest_East_18[top1] | Deepnest_East_18[bot1] | (Deepnest_East_18[right2] + SHADOWDASH)</macro>
  
  <macro name="Hive_03_c">Hive_03_c[left1] | Hive_03_c[top1] | Hive_03_c[right2] | Hive_03_c[right3]</macro>
  
  <macro name="Abyss_03">Abyss_03[top1] | (Abyss_03[bot1] + (CLAW | WINGS)) | Abyss_03[bot2]</macro>
  <macro name="Abyss_03_b">Abyss_03_b[left1]</macro>
  <macro name="Abyss_03_c">Abyss_03_c[top1] | Abyss_03_c[right1]</macro>
  <macro name="Abyss_04">Abyss_04[top1] | Abyss_04[right1] | Abyss_04[bot1] | Abyss_04[left1]</macro>
  <macro name="Abyss_06_Core">(Abyss_06_Core[top1] + BRAND) | Abyss_06_Core[left1] | Abyss_06_Core[left3] | Abyss_06_Core[bot1] | Abyss_06_Core[right2]</macro>
  <macro name="Abyss_09">(Abyss_09[left1] + ((CLAW + DASH) | WINGS)) | (Abyss_09[right1] + Abyss_Lighthouse_room[left1]) | Abyss_09[right2]</macro>
  <macro name="Abyss_19">(Abyss_19[bot1] + (CLAW | WINGS)) | Abyss_19[right1]</macro>

  <macro name="Abyss_01">Abyss_01[left1] | Abyss_01[right1] | (Abyss_01[left3] + CLAW) | ((Abyss_01[left2] | Abyss_01[right2]) + (SUPERDASH | (SPIKETUNNELS + DASH + FIREBALL + Dashmaster)))</macro>
  <macro name="Waterways_01">Waterways_01[top1] | Waterways_01[right1] | Waterways_01[bot1] | Waterways_01[left1]</macro>
  <macro name="Waterways_02">Waterways_02[top1] | Waterways_02[top2] | (Waterways_02[top3] + QUAKE) | Waterways_02[bot1] | Waterways_02[bot2]</macro>
  <macro name="Waterways_04">Waterways_04[right1] | Waterways_04[left1] | Waterways_04[left2]</macro>
  <macro name="Waterways_04b">Waterways_04b[right1] | Waterways_04b[right2] | Waterways_04b[left1]</macro>
  <macro name="Waterways_05">(Waterways_05[bot1] + CLAW) | Waterways_05[bot2] | Waterways_05[right1]</macro>
  <macro name="Waterways_07">(Waterways_07[left1] + ((ACID + (CLAW | WINGS)) | (CLAW + SUPERDASH))) | (Waterways_07[right1] + (CLAW | WINGS)) | (Waterways_07[right2] + ACID) | Waterways_07[door1] | Waterways_07[top1]</macro>
  
  <macro name="Ruins1_03">Ruins1_03[top1] | Ruins1_03[left1] | Ruins1_03[right1] | Ruins1_03[right2]</macro>
  <macro name="Ruins1_04">Ruins1_04[right1] | Ruins1_04[door1] | (Ruins1_04[bot1] + (CLAW | WINGS))</macro>
  <macro name="Ruins1_05b">Ruins1_05b[top1] | Ruins1_05b[right1] | Ruins1_05b[left1] | Ruins1_05b[bot1]</macro>
  <macro name="Ruins1_05c">Ruins1_05c[bot1] | Ruins1_05c[left2] | Ruins1_05c[top1] | Ruins1_05c[top2] | Ruins1_05c[top3]</macro>
  <macro name="Ruins1_05">Ruins1_05[bot3] | Ruins1_05[right1] | Ruins1_05[right2] | Ruins1_05[top1]</macro>
  <macro name="Ruins1_23">Ruins1_23[right2] | Ruins1_23[left1] | Ruins1_23[bot1]</macro>
  <macro name="Ruins1_28">Ruins1_28[left1] | Ruins1_28[right1] | Ruins1_28[bot1]</macro>
  <macro name="Ruins1_30">Ruins1_30[left1] | (Ruins1_30[left2] + (CLAW | WINGS) + QUAKE) | Ruins1_30[bot1] | Ruins1_30[right1]</macro>
  <macro name="Ruins1_31">Ruins1_31[right1] | Ruins1_31[left2] | Ruins1_31[left3]</macro>
  
  <macro name="Ruins2_01">Ruins2_01[top1] | Ruins2_01[bot1] | Ruins2_01[left2]</macro>
  <macro name="Ruins2_01_b">Ruins2_01_b[top1] | Ruins2_01_b[left1] | Ruins2_01_b[right1]</macro>
  <macro name="Ruins2_03b">Ruins2_03b[top1] | Ruins2_03b[top2] | Ruins2_03b[left1] | Ruins2_03b[bot1]</macro>
  <macro name="Ruins2_04">Ruins2_04[left1] | Ruins2_04[left2] | Ruins2_04[right1] | Ruins2_04[right2] | Ruins2_04[door_Ruin_House_01] | Ruins2_04[door_Ruin_House_02] | Ruins2_04[door_Ruin_House_03] | Ruins2_04[door_Ruin_Elevator]</macro>
  <macro name="Ruins2_06">Ruins2_06[left1] | Ruins2_06[left2] | Ruins2_06[top1] | Ruins2_06[right1] | Ruins2_06[right2]</macro>
  <macro name="Ruins2_07">Ruins2_07[left1] | Ruins2_07[top1] | Ruins2_07[right1]</macro>
  <macro name="Ruins2_10">Ruins2_10[right1] | Ruins2_10[left1] | Ruins2_10b[right1] | Ruins2_10b[right2] | Ruins2_10b[left1]</macro>
  
  <macro name="RestingGrounds_02">RestingGrounds_02[top1] | RestingGrounds_02[left1] | RestingGrounds_02[bot1] | RestingGrounds_02[right1]</macro>
  <macro name="RestingGrounds_05">RestingGrounds_05[left1] | RestingGrounds_05[left2] | RestingGrounds_05[left3] | RestingGrounds_05[right1] | RestingGrounds_05[right2] | RestingGrounds_05[bot1]</macro>
  <macro name="RestingGrounds_10">RestingGrounds_10[left1] | RestingGrounds_10[top1] | RestingGrounds_10[top2]</macro>
  
  <macro name="Mines_02">Mines_02[top1] | Mines_02[top2] | Mines_02[left1] | Mines_02[right1]</macro>
  <macro name="Mines_03">Mines_03[right1] | Mines_03[top1] | Mines_03[bot1]</macro>
  <macro name="Mines_04">Mines_04[left1] | Mines_04[left2] | (Mines_04[left3] + (CLAW | WINGS)) | Mines_04[right1] | Mines_04[top1]</macro>
  <macro name="Mines_05">Mines_05[right1] | Mines_05[top1] | Mines_05[bot1] | Mines_05[left1] | Mines_05[left2]</macro>
  <macro name="Mines_10">(Mines_10[left1] + ((DASH + WINGS) | SUPERDASH)) | (Mines_10[bot1] + (DASH | WINGS | SUPERDASH)) | (Mines_10[right1] + CLAW + SUPERDASH)</macro>
  <macro name="Mines_11">(Mines_11[bot1] + (CLAW | WINGS)) | Mines_11[right1] | Mines_11[top1]</macro>
  <macro name="Mines_18">Mines_18[left1] | Mines_18[right1] | Mines_18[top1]</macro>
  <macro name="Mines_20">Mines_20[left1] | Mines_20[right1] | (Mines_20[right2] + CLAW)</macro>
  <macro name="Mines_23">(DASH | WINGS | (CLAW + SUPERDASH)) + (Mines_23[left1] | Mines_23[top1] | Mines_23[right1] | Mines_23[right2])</macro>
  
  <macro name="Fungus3_04">Fungus3_04[left1] | Fungus3_04[left2] | Fungus3_04[right1] | Fungus3_04[right2]</macro>
  <macro name="Fungus3_11">Fungus3_11[left1] | (Fungus3_11[left2] + CLAW) | (Fungus3_11[right1] + (CLAW | WINGS))</macro>
  <macro name="Fungus3_13">Fungus3_13[left1] | Fungus3_13[left2] | Fungus3_13[left3] | Fungus3_13[bot1] | Fungus3_13[right1]</macro>
  <macro name="Fungus3_22">Fungus3_22[right1] | Fungus3_22[left1] | Fungus3_22[bot1]</macro>
  <macro name="Fungus3_34">Fungus3_34[left1] | Fungus3_34[right1] | Fungus3_34[top1]</macro>
  <macro name="Fungus3_40">Fungus3_40[top1] | Fungus3_40[right1]</macro>
  
  <macro name="Cliffs_01">Cliffs_01[right1] | Cliffs_01[right2] | Cliffs_01[right3] | Cliffs_01[right4]</macro>
  <macro name="Cliffs_02">(Cliffs_02[bot1] + (CLAW | WINGS)) | Cliffs_02[door1] | Cliffs_02[left1] | Cliffs_02[left2]</macro>
  
  <macro name="White_Palace_01">(White_Palace_01[left1] + (WINGS | (CLAW + DASH)))  | (White_Palace_01[right1] + (DASH | (CLAW + SUPERDASH) | WINGS)) | (White_Palace_01[top1] + White_Palace_02[left1] + CLAW + WINGS)</macro>
  <macro name="White_Palace_03_hub">White_Palace_03_hub[left1] | White_Palace_03_hub[left2] | (White_Palace_03_hub[bot1] + CLAW) | White_Palace_03_hub[right1] | (White_Palace_03_hub[top1] + ((White_Palace_14[bot1] + (CLAW | WINGS) + DASH) | White_Palace_14[right1]) + White_Palace_15[right1])</macro>
  <macro name="White_Palace_13">White_Palace_13[right1] | White_Palace_13[left1] | White_Palace_13[left2] | White_Palace_13[left3]</macro>
</randomizer>
